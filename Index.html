<!DOCTYPE html>
<html>
<head>
  <title>Getting Location...</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding-top: 50px; }
    .loader { margin: 20px auto; border: 5px solid #f3f3f3; border-top: 5px solid #3498db; border-radius: 50%; width: 50px; height: 50px; animation: spin 2s linear infinite; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
  </style>
</head>
<body>

  <h2>Please Allow Location Access</h2>
  <p>We need your location to proceed to the form.</p>
  <div class="loader"></div>
  <p id="status">Waiting for permission...</p>

  <script>
    // ==========================================
    // CONFIGURATION: EDIT THIS SECTION ONLY
    // ==========================================
    
    // 1. Paste your Google Form URL (everything BEFORE the '?')
    const formBaseURL = "https://docs.google.com/forms/d/e/1FAIpQLSeHolSKu47kuTkecLNLFhEedhm-oys-ERj7p6Y1j5RsHM4XNw/viewform";
    
    // 2. Paste the Entry ID for Latitude (numbers only)
    const latEntryID = "1131391592"; 
    
    // 3. Paste the Entry ID for Longitude (numbers only)
    const longEntryID = "1142733076"; 

    // ==========================================
    // END CONFIGURATION
    // ==========================================

    function getLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(redirectToForm, showError);
      } else {
        document.getElementById("status").innerHTML = "Geolocation is not supported by this browser.";
      }
    }

    function redirectToForm(position) {
      const lat = position.coords.latitude;
      const long = position.coords.longitude;
      
      // Construct the final URL with pre-filled data
      const finalURL = `${formBaseURL}?usp=pp_url&entry.${latEntryID}=${lat}&entry.${longEntryID}=${long}`;
      
      // Redirect the user
      window.location.href = finalURL;
    }

    function showError(error) {
      switch(error.code) {
        case error.PERMISSION_DENIED:
          document.getElementById("status").innerHTML = "User denied the request for Geolocation. Please refresh and allow location.";
          break;
        case error.POSITION_UNAVAILABLE:
          document.getElementById("status").innerHTML = "Location information is unavailable.";
          break;
        case error.TIMEOUT:
          document.getElementById("status").innerHTML = "The request to get user location timed out.";
          break;
        default:
          document.getElementById("status").innerHTML = "An unknown error occurred.";
      }
    }

    // Run immediately when page loads
    window.onload = getLocation;
  </script>

</body>
</html>