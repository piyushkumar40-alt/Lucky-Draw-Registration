<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mak Power Lucky Draw</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>

:root{
  --primary:#EE1C25;
  --bg:#f8fafc;
  --text:#1e293b;
  --light:#94a3b8;
  --card:#ffffff;
}

*{box-sizing:border-box;margin:0;padding:0;}

body{
  font-family:'Poppins',sans-serif;
  background:var(--bg);
  min-height:100vh;
}

/* HERO */
.hero{
  background:linear-gradient(135deg,#ffffff 0%,#fff3f4 100%);
  padding:50px 20px;
  text-align:center;
}

.brand-logo{
  max-width:140px;
  margin-bottom:18px;
}

.hero h1{
  font-size:26px;
  font-weight:700;
  color:var(--primary);
}

.hero p{
  font-size:14px;
  color:var(--light);
  margin-top:6px;
}

/* CARD */
.container{
  padding:20px;
  display:flex;
  justify-content:center;
}

.card{
  background:var(--card);
  width:100%;
  max-width:420px;
  padding:28px;
  border-radius:20px;
  box-shadow:0 20px 50px rgba(0,0,0,.05);
  margin-top:-40px;
}

/* FLOATING INPUT */
.input-group{
  position:relative;
  margin-bottom:22px;
}

.input-group input,
.input-group select{
  width:100%;
  padding:18px 14px 8px 14px;
  border:1px solid #e2e8f0;
  border-radius:12px;
  font-size:14px;
  background:#fff;
  transition:.2s;
}

.input-group label{
  position:absolute;
  left:14px;
  top:16px;
  font-size:14px;
  color:var(--light);
  pointer-events:none;
  transition:.2s ease all;
  background:#fff;
  padding:0 4px;
}

/* FLOATING EFFECT */
.input-group input:focus + label,
.input-group input:not(:placeholder-shown) + label,
.input-group select:focus + label,
.input-group select:not([value=""]) + label{
  top:-8px;
  font-size:11px;
  color:var(--primary);
}

input:focus, select:focus{
  outline:none;
  border-color:var(--primary);
  box-shadow:0 0 0 3px rgba(238,28,37,.1);
}

button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:12px;
  font-weight:600;
  cursor:pointer;
  transition:.2s;
}

.primary-btn{
  background:var(--primary);
  color:#fff;
  box-shadow:0 10px 25px rgba(238,28,37,.2);
}

.primary-btn:hover{
  transform:translateY(-2px);
}

.hidden{display:none;}

.msg{
  font-size:13px;
  margin-top:10px;
}

.success{color:#16a34a;}
.error{color:#dc2626;}

/* LOADING */
.overlay{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(255,255,255,.9);
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:999;
  display:none;
}

.loader{
  width:50px;
  height:50px;
  border:5px solid #f3f3f3;
  border-top:5px solid var(--primary);
  border-radius:50%;
  animation:spin 1s linear infinite;
}

@keyframes spin{
  0%{transform:rotate(0deg);}
  100%{transform:rotate(360deg);}
}

.footer{
  text-align:center;
  font-size:12px;
  color:var(--light);
  padding:20px;
}

</style>
</head>

<body>

<div class="overlay" id="overlay">
  <div class="loader"></div>
</div>

<div class="hero">
  <img src="Mak_Logo 1212.jpg" class="brand-logo">
  <h1>Mak Power Lucky Draw</h1>
  <p>Enter your coupon code & win exciting rewards</p>
</div>

<div class="container">
  <div class="card">

    <div class="input-group">
      <input type="text" id="couponCode" placeholder=" ">
      <label>Coupon Code</label>
    </div>

    <button class="primary-btn" onclick="checkCoupon()">Verify Coupon</button>

    <div id="mainMsg" class="msg"></div>

    <div id="formSection" class="hidden">

      <div class="input-group">
        <input type="text" id="fullName" placeholder=" ">
        <label>Full Name</label>
      </div>

      <div class="input-group">
        <input type="tel" id="mobile" placeholder=" ">
        <label>Whatsapp Mobile</label>
      </div>

      <div class="input-group">
        <input type="text" id="shop" placeholder=" ">
        <label>Shop Name</label>
      </div>

      <div class="input-group">
        <select id="role" required>
          <option value="" disabled selected hidden></option>
          <option value="SS">SS</option>
          <option value="Distributor">Distributor</option>
          <option value="Dealer">Dealer</option>
        </select>
        <label>Role</label>
      </div>

      <div class="input-group">
        <input type="text" id="district" placeholder=" ">
        <label>District</label>
      </div>

      <button class="primary-btn" onclick="submitForm()">Submit Registration</button>

    </div>

  </div>
</div>

<div class="footer">
  Â© 2026 Mak Power
</div>

<script>

const scriptURL="https://script.google.com/macros/s/AKfycbywwNqeEiCL9MFH_gCaBdOVPAuATkiXvMiDM3XPI72CD5YBVfHpZ1EoFvm9jdgfFAEEkw/exec";

let couponVerified=false;

function normalize(code){
  return code.replace(/\D/g,'');
}

function showOverlay(){document.getElementById("overlay").style.display="flex";}
function hideOverlay(){document.getElementById("overlay").style.display="none";}

function showMsg(msg,type){
  const el=document.getElementById("mainMsg");
  el.innerText=msg;
  el.className="msg "+type;
}

function checkCoupon(){
  const code=normalize(document.getElementById("couponCode").value);

  if(code.length<6){
    showMsg("Enter valid coupon code","error");
    return;
  }

  showOverlay();

  fetch(`${scriptURL}?q=${code}`)
  .then(res=>res.json())
  .then(data=>{
    hideOverlay();

    if(data.valid){
      couponVerified=true;
      showMsg("Coupon verified successfully","success");
      document.getElementById("formSection").classList.remove("hidden");
    }else{
      if(data.reason==="used"){
        showMsg("Coupon already used","error");
      }else{
        showMsg("Invalid coupon","error");
      }
    }
  })
  .catch(()=>{
    hideOverlay();
    showMsg("Connection error","error");
  });
}

function submitForm(){

  if(!couponVerified){
    showMsg("Verify coupon first","error");
    return;
  }

  const name=document.getElementById("fullName").value.trim();
  const mobile=document.getElementById("mobile").value.trim();
  const shop=document.getElementById("shop").value.trim();
  const role=document.getElementById("role").value;
  const district=document.getElementById("district").value.trim();
  const couponCode=normalize(document.getElementById("couponCode").value);

  if(!name||!mobile||!shop||!role||!district){
    showMsg("All fields are required","error");
    return;
  }

  showOverlay();

  fetch(scriptURL,{
    method:"POST",
    body:JSON.stringify({
      name:name,
      couponCode:couponCode,
      mobile:mobile,
      shop:shop,
      role:role,
      district:district,
      lat:"",
      long:""
    })
  })
  .then(res=>res.text())
  .then(text=>{
    hideOverlay();
    const data=JSON.parse(text);

    if(data.status==="success"){
      showMsg("Registration Successful ðŸŽ‰","success");
      document.getElementById("formSection").classList.add("hidden");
    }else{
      showMsg(data.message,"error");
    }
  })
  .catch(()=>{
    hideOverlay();
    showMsg("Submission failed","error");
  });
}

</script>

</body>
</html>
